

Demonstration program for ARKODE - SPGMR linear solver

Food web problem with ns species, ns = 6
Predator-prey interaction and diffusion on a 2-D square

Matrix parameters: a = 1   e = 1e+04   g = 5e-07
b parameter = 1
Diffusion coefficients: Dprey = 1   Dpred = 0.5
Rate parameter alpha = 1

Mesh dimensions (mx,my) are 6, 6.  Total system size is neq = 216 

Tolerances: reltol = 1e-05, abstol = 1e-05 

Preconditioning uses a product of:
  (1) Gauss-Seidel iterations with itmax = 5 iterations, and
  (2) interaction-only block-diagonal matrix with block-grouping
  Number of diagonal block groups = ngrp = 4  (ngx by ngy, ngx = 2, ngy = 2)


----------------------------------------------------------------------------


Preconditioner type is           jpre = SUN_PREC_LEFT

Gram-Schmidt method type is    gstype = SUN_MODIFIED_GS


c values at t = 0:

Species 1
10        10        10        10        10        10        
10        10.1678   10.3775   10.3775   10.1678   10        
10        10.3775   10.8493   10.8493   10.3775   10        
10        10.3775   10.8493   10.8493   10.3775   10        
10        10.1678   10.3775   10.3775   10.1678   10        
10        10        10        10        10        10        

Species 2
10        10        10        10        10        10        
10        10.3355   10.755    10.755    10.3355   10        
10        10.755    11.6987   11.6987   10.755    10        
10        10.755    11.6987   11.6987   10.755    10        
10        10.3355   10.755    10.755    10.3355   10        
10        10        10        10        10        10        

Species 3
10        10        10        10        10        10        
10        10.5033   11.1325   11.1325   10.5033   10        
10        11.1325   12.548    12.548    11.1325   10        
10        11.1325   12.548    12.548    11.1325   10        
10        10.5033   11.1325   11.1325   10.5033   10        
10        10        10        10        10        10        

Species 4
10        10        10        10        10        10        
10        10.6711   11.5099   11.5099   10.6711   10        
10        11.5099   13.3974   13.3974   11.5099   10        
10        11.5099   13.3974   13.3974   11.5099   10        
10        10.6711   11.5099   11.5099   10.6711   10        
10        10        10        10        10        10        

Species 5
10        10        10        10        10        10        
10        10.8389   11.8874   11.8874   10.8389   10        
10        11.8874   14.2467   14.2467   11.8874   10        
10        11.8874   14.2467   14.2467   11.8874   10        
10        10.8389   11.8874   11.8874   10.8389   10        
10        10        10        10        10        10        

Species 6
10        10        10        10        10        10        
10        11.0066   12.2649   12.2649   11.0066   10        
10        12.2649   15.0961   15.0961   12.2649   10        
10        12.2649   15.0961   15.0961   12.2649   10        
10        11.0066   12.2649   12.2649   11.0066   10        
10        10        10        10        10        10        

t =   1.00e-08  nst = 4  nfe = 0  nfi = 64  nni = 41  hu =    2.30e-08

t =   1.00e-07  nst = 5  nfe = 0  nfi = 80  nni = 52  hu =    8.55e-08

t =   1.00e-06  nst = 8  nfe = 0  nfi = 130  nni = 87  hu =    4.75e-07

c values at t = 1e-06:

Species 1
9.99991   9.99992   9.99993   9.99993   9.99993   9.99992   
9.99992   10.1677   10.3774   10.3774   10.1677   9.99993   
9.99993   10.3774   10.8492   10.8492   10.3774   9.99993   
9.99993   10.3774   10.8492   10.8492   10.3774   9.99993   
9.99992   10.1677   10.3774   10.3774   10.1677   9.99992   
9.99991   9.99992   9.99993   9.99993   9.99992   9.99991   

Species 2
9.99991   9.99993   9.99995   9.99995   9.99993   9.99992   
9.99993   10.3355   10.7549   10.7549   10.3355   9.99993   
9.99995   10.7549   11.6985   11.6985   10.7549   9.99995   
9.99995   10.7549   11.6985   11.6985   10.7549   9.99995   
9.99993   10.3355   10.7549   10.7549   10.3355   9.99993   
9.99991   9.99993   9.99995   9.99995   9.99993   9.99991   

Species 3
9.99991   9.99994   9.99997   9.99997   9.99994   9.99992   
9.99994   10.5032   11.1323   11.1323   10.5032   9.99994   
9.99997   11.1323   12.5478   12.5478   11.1323   9.99997   
9.99997   11.1323   12.5478   12.5478   11.1323   9.99997   
9.99994   10.5032   11.1323   11.1323   10.5032   9.99994   
9.99991   9.99994   9.99997   9.99997   9.99994   9.99991   

Species 4
13.4984   13.4984   13.4985   13.4984   13.4984   13.4984   
13.4984   14.55     15.8924   15.8924   14.55     13.4984   
13.4985   15.8924   19.0296   19.0296   15.8924   13.4984   
13.4985   15.8924   19.0296   19.0296   15.8924   13.4985   
13.4984   14.55     15.8924   15.8924   14.55     13.4984   
13.4984   13.4984   13.4985   13.4985   13.4984   13.4984   

Species 5
13.4984   13.4984   13.4985   13.4985   13.4984   13.4984   
13.4984   14.7787   16.4136   16.4136   14.7787   13.4984   
13.4985   16.4136   20.236    20.236    16.4136   13.4985   
13.4985   16.4136   20.236    20.236    16.4136   13.4985   
13.4984   14.7787   16.4136   16.4136   14.7787   13.4984   
13.4984   13.4984   13.4985   13.4985   13.4984   13.4984   

Species 6
13.4984   13.4984   13.4985   13.4985   13.4984   13.4984   
13.4984   15.0075   16.9349   16.9348   15.0075   13.4984   
13.4985   16.9349   21.4423   21.4423   16.9348   13.4985   
13.4985   16.9349   21.4423   21.4423   16.9349   13.4985   
13.4984   15.0075   16.9349   16.9349   15.0075   13.4984   
13.4984   13.4984   13.4985   13.4985   13.4984   13.4984   

t =   1.00e-05  nst = 28  nfe = 0  nfi = 433  nni = 290  hu =    4.63e-07

t =   1.00e-04  nst = 109  nfe = 0  nfi = 1758  nni = 1210  hu =    1.29e-05

t =   1.00e-03  nst = 170  nfe = 0  nfi = 2679  nni = 1826  hu =    1.99e-05

c values at t = 0.001:

Species 1
9.907     9.91663   9.92834   9.93032   9.92257   9.91673   
9.91471   10.0746   10.2768   10.2785   10.0795   9.92257   
9.92443   10.2748   10.7181   10.7194   10.2785   9.93032   
9.92443   10.2744   10.7173   10.7181   10.2768   9.92834   
9.91467   10.0735   10.2744   10.2748   10.0746   9.91663   
9.90696   9.91467   9.92443   9.92443   9.91471   9.907     

Species 2
9.90742   9.92472   9.94623   9.94817   9.9306    9.91711   
9.9228    10.2412   10.644    10.6457   10.2461   9.9306    
9.94236   10.642    11.5267   11.5281   10.6457   9.94817   
9.94234   10.6415   11.5258   11.5267   10.644    9.94623   
9.92278   10.24     10.6415   10.642    10.2412   9.92472   
9.90737   9.92278   9.94234   9.94236   9.9228    9.90742   

Species 3
9.90782   9.93277   9.96406   9.96607   9.93873   9.91751   
9.93091   10.4078   11.011    11.0127   10.4127   9.93873   
9.96018   11.0087   12.3339   12.3354   11.0127   9.96607   
9.96017   11.0083   12.333    12.3339   11.011    9.96406   
9.93088   10.4065   11.0083   11.0087   10.4078   9.93277   
9.90776   9.93088   9.96017   9.96018   9.93091   9.90782   

Species 4
297231    297749    298393    298451    297925    297520    
297692    307245    319327    319377    307391    297925    
298277    319265    345798    345840    319377    298451    
298276    319252    345772    345798    319327    298393    
297691    307209    319252    319265    307245    297749    
297230    297691    298276    298277    297692    297231    

Species 5
297231    297749    298393    298451    297925    297520    
297692    307245    319327    319377    307391    297925    
298277    319265    345799    345840    319377    298451    
298276    319252    345772    345798    319327    298393    
297691    307209    319252    319265    307245    297749    
297230    297691    298276    298277    297692    297231    

Species 6
297231    297749    298393    298451    297925    297520    
297692    307245    319327    319377    307390    297925    
298277    319265    345799    345840    319377    298451    
298276    319252    345772    345798    319328    298393    
297691    307209    319252    319265    307245    297749    
297230    297691    298276    298277    297692    297231    

t =   1.00e-02  nst = 623  nfe = 0  nfi = 9520  nn
[ARKode ERROR]  arkEvolve
  At t = 0.0327983, mxstep steps taken before reaching tout.


SUNDIALS_ERROR: ARKStepEvolve() failed with flag = -1


[ARKode ERROR]  arkEvolve
  At t = 0.0313238, mxstep steps taken before reaching tout.


SUNDIALS_ERROR: ARKStepEvolve() failed with flag = -1


[ARKode ERROR]  arkEvolve
  At t = 0.0322659, mxstep steps taken before reaching tout.


SUNDIALS_ERROR: ARKStepEvolve() failed with flag = -1

i = 6402  hu =    1.99e-05

t =   3.28e-02  nst = 1623  nfe = 0  nfi = 24619  nni = 16501  hu =    3.04e-05



 Final statistics for this run:

 ARKStep real workspace length         = 3557 
 ARKStep integer workspace length      =  129 
 ARKLS real workspace length           = 2647 
 ARKLS integer workspace length        =   42 
 Number of steps                       = 1623 
 Number of f-s (explicit)              =    0 
 Number of f-s (implicit)              = 24619 
 Number of f-s (SPGMR)                 = 52740 
 Number of f-s (TOTAL)                 = 52740 
 Number of setups                      =   95 
 Number of nonlinear iterations        = 16501 
 Number of linear iterations           = 52740 
 Number of preconditioner evaluations  =   95 
 Number of preconditioner solves       = 69233 
 Number of error test failures         =    0 
 Number of nonlinear conv. failures    =    2 
 Number of linear convergence failures = 2221 
 Average Krylov subspace dimension     = 3.196 


----------------------------------------------------------------------------
----------------------------------------------------------------------------


Preconditioner type is           jpre = SUN_PREC_LEFT

Gram-Schmidt method type is    gstype = SUN_CLASSICAL_GS


t =   1.00e-08  nst = 4  nfe = 0  nfi = 63  nni = 40  hu =    2.30e-08

t =   1.00e-07  nst = 5  nfe = 0  nfi = 79  nni = 51  hu =    8.55e-08

t =   1.00e-06  nst = 8  nfe = 0  nfi = 129  nni = 86  hu =    4.75e-07

t =   1.00e-05  nst = 28  nfe = 0  nfi = 432  nni = 289  hu =    4.63e-07

t =   1.00e-04  nst = 111  nfe = 0  nfi = 1810  nni = 1248  hu =    1.15e-05

t =   1.00e-03  nst = 164  nfe = 0  nfi = 2611  nni = 1784  hu =    1.73e-05

t =   1.00e-02  nst = 684  nfe = 0  nfi = 10462  nni = 7035  hu =    1.73e-05

t =   3.13e-02  nst = 1684  nfe = 0  nfi = 25558  nni = 17131  hu =    2.66e-05



 Final statistics for this run:

 ARKStep real workspace length         = 3557 
 ARKStep integer workspace length      =  134 
 ARKLS real workspace length           = 2647 
 ARKLS integer workspace length        =   42 
 Number of steps                       = 1684 
 Number of f-s (explicit)              =    0 
 Number of f-s (implicit)              = 25558 
 Number of f-s (SPGMR)                 = 53343 
 Number of f-s (TOTAL)                 = 53343 
 Number of setups                      =  101 
 Number of nonlinear iterations        = 17131 
 Number of linear iterations           = 53343 
 Number of preconditioner evaluations  =  101 
 Number of preconditioner solves       = 70465 
 Number of error test failures         =    0 
 Number of nonlinear conv. failures    =    3 
 Number of linear convergence failures = 1214 
 Average Krylov subspace dimension     = 3.114 


----------------------------------------------------------------------------
----------------------------------------------------------------------------


Preconditioner type is           jpre = SUN_PREC_RIGHT

Gram-Schmidt method type is    gstype = SUN_MODIFIED_GS


t =   1.00e-08  nst = 4  nfe = 0  nfi = 64  nni = 41  hu =    2.30e-08

t =   1.00e-07  nst = 5  nfe = 0  nfi = 81  nni = 53  hu =    8.55e-08

t =   1.00e-06  nst = 8  nfe = 0  nfi = 131  nni = 88  hu =    4.76e-07

t =   1.00e-05  nst = 28  nfe = 0  nfi = 434  nni = 291  hu =    4.63e-07

t =   1.00e-04  nst = 111  nfe = 0  nfi = 1846  nni = 1280  hu =    1.14e-05

t =   1.00e-03  nst = 162  nfe = 0  nfi = 2617  nni = 1796  hu =    1.78e-05

t =   1.00e-02  nst = 669  nfe = 0  nfi = 10272  nni = 6916  hu =    1.78e-05

t =   3.23e-02  nst = 1669  nfe = 0  nfi = 25372  nni = 17016  hu =    4.03e-05



 Final statistics for this run:

 ARKStep real workspace length         = 3557 
 ARKStep integer workspace length      =  139 
 ARKLS real workspace length           = 2647 
 ARKLS integer workspace length        =   42 
 Number of steps                       = 1669 
 Number of f-s (explicit)              =    0 
 Number of f-s (implicit)              = 25372 
 Number of f-s (SPGMR)                 = 58897 
 Number of f-s (TOTAL)                
[ARKode ERROR]  arkEvolve
  At t = 0.0310197, mxstep steps taken before reaching tout.


SUNDIALS_ERROR: ARKStepEvolve() failed with flag = -1

 = 58897 
 Number of setups                      =  111 
 Number of nonlinear iterations        = 17016 
 Number of linear iterations           = 58897 
 Number of preconditioner evaluations  =  111 
 Number of preconditioner solves       = 75904 
 Number of error test failures         =    0 
 Number of nonlinear conv. failures    =    9 
 Number of linear convergence failures = 2416 
 Average Krylov subspace dimension     = 3.461 


----------------------------------------------------------------------------
----------------------------------------------------------------------------


Preconditioner type is           jpre = SUN_PREC_RIGHT

Gram-Schmidt method type is    gstype = SUN_CLASSICAL_GS


t =   1.00e-08  nst = 4  nfe = 0  nfi = 63  nni = 40  hu =    2.30e-08

t =   1.00e-07  nst = 5  nfe = 0  nfi = 79  nni = 51  hu =    8.55e-08

t =   1.00e-06  nst = 8  nfe = 0  nfi = 129  nni = 86  hu =    4.75e-07

t =   1.00e-05  nst = 28  nfe = 0  nfi = 432  nni = 289  hu =    4.63e-07

t =   1.00e-04  nst = 111  nfe = 0  nfi = 1838  nni = 1271  hu =    1.12e-05

t =   1.00e-03  nst = 163  nfe = 0  nfi = 2624  nni = 1797  hu =    1.74e-05

t =   1.00e-02  nst = 679  nfe = 0  nfi = 10416  nni = 7009  hu =    1.74e-05

t =   3.10e-02  nst = 1679  nfe = 0  nfi = 25514  nni = 17107  hu =    2.62e-05



 Final statistics for this run:

 ARKStep real workspace length         = 3557 
 ARKStep integer workspace length      =  144 
 ARKLS real workspace length           = 2647 
 ARKLS integer workspace length        =   42 
 Number of steps                       = 1679 
 Number of f-s (explicit)              =    0 
 Number of f-s (implicit)              = 25514 
 Number of f-s (SPGMR)                 = 58560 
 Number of f-s (TOTAL)                 = 58560 
 Number of setups                      =  109 
 Number of nonlinear iterations        = 17107 
 Number of linear iterations           = 58560 
 Number of preconditioner evaluations  =  109 
 Number of preconditioner solves       = 75658 
 Number of error test failures         =    0 
 Number of nonlinear conv. failures    =    7 
 Number of linear convergence failures = 1265 
 Average Krylov subspace dimension     = 3.423 


----------------------------------------------------------------------------
----------------------------------------------------------------------------
